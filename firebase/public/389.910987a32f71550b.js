"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[389],{389:(I,Z,d)=>{d.r(Z),d.d(Z,{RegistroPageModule:()=>U});var v=d(6814),t=d(95),n=d(9810),_=d(1147),u=d(5861),h=d(203),e=d(9212);let A=(()=>{var i;class r{constructor(a,o){this.modalController=a,this.formBuilder=o}ngOnInit(){this.formularioAlmacen=this.formBuilder.group({clave_almacen:[this.almacen.clave_almacen,t.kI.required],localizacion_descripcion_almacen:[this.almacen.localizacion_descripcion_almacen,t.kI.required],vigencia_calibracion_tanque:[this.almacen.vigencia_calibracion_tanque,t.kI.required],capacidad_almacen:[this.almacen.capacidad_almacen,t.kI.required],capacidad_operativa:[this.almacen.capacidad_operativa,t.kI.required],capacidad_util:[this.almacen.capacidad_util,t.kI.required],capacidad_fondaje:[this.almacen.capacidad_fondaje,t.kI.required],volumen_minimo_operacion:[this.almacen.volumen_minimo_operacion,t.kI.required],estado_tanque:[this.almacen.estado_tanque,t.kI.required]})}cerrarModal(){this.modalController.dismiss()}guardarCambios(){this.modalController.dismiss(this.formularioAlmacen.value)}}return(i=r).\u0275fac=function(a){return new(a||i)(e.Y36(n.IN),e.Y36(t.qu))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-editar-almacen"]],inputs:{almacen:"almacen"},standalone:!0,features:[e.jDz],decls:42,vars:3,consts:[[2,"--background","#2c3d50"],[2,"color","white"],["slot","end"],[2,"color","white",3,"strong","click"],[3,"formGroup","ngSubmit"],["label","Clave del almacen","labelPlacement","floating","formControlName","clave_almacen","type","text","placeholder","Ingrese la clave del almacen"],["label","Localizaci\xf3n y descripci\xf3n","labelPlacement","floating","formControlName","localizacion_descripcion_almacen","placeholder","Ingrese la descripci\xf3n de la pipa",3,"autoGrow"],[1,"row"],[1,"col-md-6"],["label","Capacidad","labelPlacement","floating","formControlName","capacidad_almacen","type","number","placeholder","Ingrese la capcidad en Litros del almacen"],["label","Vigencia de calibraci\xf3n del almacen","labelPlacement","floating","formControlName","vigencia_calibracion_tanque","type","date","placeholder","Ingrese la \xfaltima fecha en la que se calibr\xf3"],["label","Capacidad operativa","labelPlacement","floating","formControlName","capacidad_operativa","type","number","placeholder","Cantidad m\xe1xima en la que opera del almacen"],["label","Capacidad \xfatil","labelPlacement","floating","formControlName","capacidad_util","type","number","placeholder","Cantidad \xfatil en la que opera del almacen"],["label","Capacidad fondaje","labelPlacement","floating","formControlName","capacidad_fondaje","type","number","placeholder","Cantidad fondaje en la que opera del almacen"],["label","Valor minimo de operaci\xf3n","labelPlacement","floating","formControlName","volumen_minimo_operacion","type","number","placeholder","Cantidad m\xednima en la que opera del almacen"],["label","Estado del autotanque","labelPlacement","floating","formControlName","estado_tanque","placeholder","Estado del autotanque"],["value","O"],["value","F"],["type","submit","expand","full",2,"padding-top","2%"]],template:function(a,o){1&a&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e._uU(3,"Editar almacen"),e.qZA(),e.TgZ(4,"ion-buttons",2)(5,"ion-button",3),e.NdJ("click",function(){return o.cerrarModal()}),e._uU(6,"Cancelar"),e.qZA()()()(),e.TgZ(7,"ion-content")(8,"form",4),e.NdJ("ngSubmit",function(){return o.guardarCambios()}),e.TgZ(9,"ion-item"),e._UZ(10,"ion-input",5),e.qZA(),e.TgZ(11,"ion-item"),e._UZ(12,"ion-textarea",6),e.qZA(),e.TgZ(13,"div",7)(14,"div",8)(15,"ion-item"),e._UZ(16,"ion-input",9),e.qZA()(),e.TgZ(17,"div",8)(18,"ion-item"),e._UZ(19,"ion-input",10),e.qZA()()(),e.TgZ(20,"div",7)(21,"div",8)(22,"ion-item"),e._UZ(23,"ion-input",11),e.qZA()(),e.TgZ(24,"div",8)(25,"ion-item"),e._UZ(26,"ion-input",12),e.qZA()()(),e.TgZ(27,"div",7)(28,"div",8)(29,"ion-item"),e._UZ(30,"ion-input",13),e.qZA()(),e.TgZ(31,"div",8)(32,"ion-item"),e._UZ(33,"ion-input",14),e.qZA()()(),e.TgZ(34,"ion-item")(35,"ion-select",15)(36,"ion-select-option",16),e._uU(37,"En operaci\xf3n"),e.qZA(),e.TgZ(38,"ion-select-option",17),e._uU(39,"Fuera de operaci\xf3n"),e.qZA()()(),e.TgZ(40,"ion-button",18),e._uU(41,"Guardar"),e.qZA()()()),2&a&&(e.xp6(5),e.Q6J("strong",!0),e.xp6(3),e.Q6J("formGroup",o.formularioAlmacen),e.xp6(4),e.Q6J("autoGrow",!0))},dependencies:[v.ez,t.u5,t._Y,t.JJ,t.JL,n.Pc,n.YG,n.Sm,n.W2,n.Gu,n.pK,n.Ie,n.t9,n.n0,n.g2,n.wd,n.sr,n.as,n.QI,n.j9,t.UX,t.sg,t.u]}),r})();var q=d(8056),C=d(4228);function T(i,r){if(1&i){const l=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar",11),e._UZ(2,"ion-buttons",12),e.TgZ(3,"ion-buttons",13)(4,"ion-button",14),e.NdJ("click",function(){e.CHM(l);const o=e.oxw();return e.KtG(o.cancel())}),e._uU(5,"Cancelar"),e.qZA()()()(),e.TgZ(6,"ion-content",15)(7,"ion-card",16)(8,"ion-card-header")(9,"ion-card-title"),e._uU(10,"Registro de almacen"),e.qZA(),e.TgZ(11,"ion-card-subtitle"),e._uU(12,"Favor de ingresar la infromaci\xf3n correspondiente para registrar un almacen"),e.qZA()()(),e.TgZ(13,"form",17),e.NdJ("ngSubmit",function(){e.CHM(l);const o=e.oxw();return e.KtG(o.onSubmit())}),e.TgZ(14,"ion-item"),e._UZ(15,"ion-input",18),e.qZA(),e.TgZ(16,"ion-item"),e._UZ(17,"ion-textarea",19),e.qZA(),e.TgZ(18,"div",3)(19,"div",20)(20,"ion-item"),e._UZ(21,"ion-input",21),e.qZA()(),e.TgZ(22,"div",20)(23,"ion-item"),e._UZ(24,"ion-input",22),e.qZA()()(),e.TgZ(25,"div",3)(26,"div",20)(27,"ion-item"),e._UZ(28,"ion-input",23),e.qZA()(),e.TgZ(29,"div",20)(30,"ion-item"),e._UZ(31,"ion-input",24),e.qZA()()(),e.TgZ(32,"div",3)(33,"div",20)(34,"ion-item"),e._UZ(35,"ion-input",25),e.qZA()(),e.TgZ(36,"div",20)(37,"ion-item"),e._UZ(38,"ion-input",26),e.qZA()()(),e.TgZ(39,"ion-item")(40,"ion-select",27)(41,"ion-select-option",28),e._uU(42,"En operaci\xf3n"),e.qZA(),e.TgZ(43,"ion-select-option",29),e._uU(44,"Fuera de operaci\xf3n"),e.qZA()()(),e.TgZ(45,"ion-button",30),e._uU(46,"Guardar"),e.qZA()()()}if(2&i){const l=e.oxw();e.xp6(4),e.Q6J("strong",!0),e.xp6(9),e.Q6J("formGroup",l.formularioAlmacen),e.xp6(4),e.Q6J("autoGrow",!0)}}const y=[{path:"",component:(()=>{var i;class r{constructor(a,o,s,m,c,g,p){this.api=a,this.storage=o,this.modal=s,this.formBuilder=m,this.toastController=c,this.alertController=g,this.route=p}ngOnInit(){this.storage.getUserLogged()||(this.storage.logout(),this.route.navigate(["/login"],{replaceUrl:!0}))}ionViewDidEnter(){var a=this;return(0,u.Z)(function*(){yield a.getInformacion(),a.formularioAlmacen=a.formBuilder.group({id_planta:[a.token.user.id_planta,t.kI.required],clave_almacen:["",t.kI.required],localizacion_descripcion_almacen:["",t.kI.required],vigencia_calibracion_tanque:["",t.kI.required],capacidad_almacen:["",t.kI.required],capacidad_operativa:["",t.kI.required],capacidad_util:["",t.kI.required],capacidad_fondaje:["",t.kI.required],volumen_minimo_operacion:["",t.kI.required],estado_tanque:["",t.kI.required]})})()}presentToast(a,o,s){var m=this;return(0,u.Z)(function*(){yield(yield m.toastController.create({message:o,duration:1500,position:a,color:s})).present()})()}getInformacion(){var a=this;return(0,u.Z)(function*(){a.token=a.storage.getUserData(),(yield a.api.getAlmacen(a.token.token,a.token.user.id_planta)).subscribe(o=>{a.almacenes=o,a.generarTablaAlmacen(o)})})()}generarTablaAlmacen(a){var o=this;return(0,u.Z)(function*(){setTimeout(()=>{},300),new h.Z("#listaAlmacenes",{language:{url:"/assets/utils/es-ES.json"},columns:[{data:"clave_almacen",title:"Clave almacen"},{data:"vigencia_calibracion_tanque",title:"Calibraci\xf3n"},{data:"estado_tanque",title:"Estado del tanque"},{title:"Operaciones",orderable:!1,searchable:!1,data:null}],data:a,createdRow:(m,c,g)=>{const p=document.createElement("ion-button");p.setAttribute("size","small"),p.innerHTML='<ion-icon name="create"></ion-icon>',p.addEventListener("click",()=>o.abrirModalEditarAlmacen(c.id)),p.style.marginRight="15%";const f=document.createElement("ion-button");f.setAttribute("size","small"),f.setAttribute("color","danger"),f.innerHTML='<ion-icon name="trash"></ion-icon>',f.addEventListener("click",()=>o.eliminarAlmacen(c.id));const b=m.getElementsByTagName("td")[3];b.innerHTML="",b.appendChild(p),b.appendChild(f)}})})()}abrirModalEditarAlmacen(a){var o=this;return(0,u.Z)(function*(){const s=o.almacenes.find(g=>g.id===a),m=yield o.modal.create({component:A,componentProps:{almacen:s}});yield m.present();const{data:c}=yield m.onWillDismiss();c&&(yield o.api.editAlmacen(a,c,o.token.token)).subscribe(g=>{o.presentToast("bottom","Registro editado correctamente","success"),setTimeout(()=>{window.location.reload()},1e3)})})()}eliminarAlmacen(a){var o=this;return(0,u.Z)(function*(){var m;yield(yield o.alertController.create({header:"Confirmar Eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que deseas eliminar este registro?",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{console.log("Eliminaci\xf3n cancelada")}},{text:"Eliminar",handler:(m=(0,u.Z)(function*(){try{(yield o.api.deleteAlmacen(a,o.token.token)).subscribe(c=>{o.presentToast("bottom","Registro eliminado correctamente","success"),window.location.reload()})}catch(c){console.error("Error al eliminar el registro",c),o.presentToast("bottom","Error al eliminar el registro","danger")}}),function(){return m.apply(this,arguments)})}]})).present()})()}onSubmit(){var a=this;return(0,u.Z)(function*(){a.formularioAlmacen.valid?(yield a.api.createAlmacen(a.formularioAlmacen.value,a.token.token)).subscribe({next:()=>{a.presentToast("bottom","Se agregado un registro!","success"),a.formularioAlmacen.reset(),window.location.reload(),a.modal.dismiss()},error:o=>{console.log("\u{1f680} ~ MostrarPage ~ err:",o),a.presentToast("bottom","Algo ha salido mal","danger")}}):console.log("El formulario no es v\xe1lido")})()}cancel(){this.modal.dismiss(null,"cancel")}}return(i=r).\u0275fac=function(a){return new(a||i)(e.Y36(q.Z),e.Y36(C.V),e.Y36(n.IN),e.Y36(t.qu),e.Y36(n.yF),e.Y36(n.Br),e.Y36(_.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-registro"]],decls:17,vars:1,consts:[[3,"fullscreen"],[1,"card","ion-margin","rounded"],[1,"card-hedaer","text-white","ion-padding",2,"background","#2c3d50"],[1,"row"],[1,"col-md-10","pt-2"],[1,"col-md-2",2,"text-align","center"],["id","agregarAlmacenModal","color","light"],["slot","start","name","add"],["trigger","agregarAlmacenModal"],[1,"table-responsive","p-2"],["id","listaAlmacenes",1,"table"],[2,"--background","#2c3d50"],["slot","start"],["slot","end"],[2,"color","white",3,"strong","click"],[1,"ion-padding"],["color","warning",1,"text-center"],[3,"formGroup","ngSubmit"],["label","Clave del almacen","labelPlacement","floating","formControlName","clave_almacen","type","text","placeholder","Ingrese la clave del almacen"],["label","Localizaci\xf3n y descripci\xf3n","labelPlacement","floating","formControlName","localizacion_descripcion_almacen","placeholder","Ingrese la descripci\xf3n de la pipa",3,"autoGrow"],[1,"col-md-6"],["label","Capacidad","labelPlacement","floating","formControlName","capacidad_almacen","type","number","placeholder","Ingrese la capcidad en Litros del almacen"],["label","Vigencia de calibraci\xf3n del almacen","labelPlacement","floating","formControlName","vigencia_calibracion_tanque","type","date","placeholder","Ingrese la \xfaltima fecha en la que se calibr\xf3"],["label","Capacidad operativa","labelPlacement","floating","formControlName","capacidad_operativa","type","number","placeholder","Cantidad m\xe1xima en la que opera del almacen"],["label","Capacidad \xfatil","labelPlacement","floating","formControlName","capacidad_util","type","number","placeholder","Cantidad \xfatil en la que opera del almacen"],["label","Capacidad fondaje","labelPlacement","floating","formControlName","capacidad_fondaje","type","number","placeholder","Cantidad fondaje en la que opera del almacen"],["label","Valor minimo de operaci\xf3n","labelPlacement","floating","formControlName","volumen_minimo_operacion","type","number","placeholder","Cantidad m\xednima en la que opera del almacen"],["label","Estado del autotanque","labelPlacement","floating","formControlName","estado_tanque","placeholder","Estado del autotanque"],["value","O"],["value","F"],["type","submit","expand","full",2,"padding-top","2%"]],template:function(a,o){1&a&&(e.TgZ(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4"),e._uU(6,"Lista de almacenes disponibles"),e.qZA()(),e.TgZ(7,"div",5)(8,"ion-button",6),e._UZ(9,"ion-icon",7),e._uU(10," Agregar "),e._UZ(11,"br"),e._uU(12," Almacen "),e.qZA(),e.TgZ(13,"ion-modal",8),e.YNc(14,T,47,3,"ng-template"),e.qZA()()()(),e.TgZ(15,"div",9),e._UZ(16,"table",10),e.qZA()()()),2&a&&e.Q6J("fullscreen",!0)},dependencies:[t._Y,t.JJ,t.JL,n.YG,n.Sm,n.PM,n.Zi,n.tO,n.Dq,n.W2,n.Gu,n.gu,n.pK,n.Ie,n.t9,n.n0,n.g2,n.sr,n.ki,n.as,n.QI,n.j9,t.sg,t.u]}),r})()}];let P=(()=>{var i;class r{}return(i=r).\u0275fac=function(a){return new(a||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[_.Bz.forChild(y),_.Bz]}),r})(),U=(()=>{var i;class r{}return(i=r).\u0275fac=function(a){return new(a||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[v.ez,t.u5,n.Pc,P,t.UX]}),r})()}}]);