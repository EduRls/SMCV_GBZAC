"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1215],{1215:(I,v,r)=>{r.r(v),r.d(v,{MostrarPageModule:()=>q});var _=r(6814),l=r(95),o=r(9810),Z=r(1147),d=r(5861),g=r(2276),b=r(203),a=r(9212),f=r(8056),h=r(7973),A=r(4228);function T(n,c){if(1&n&&(a.TgZ(0,"ion-select-option",15),a._uU(1),a.qZA()),2&n){const i=c.$implicit;a.s9C("value",i.id),a.xp6(),a.Oqu(i.clave_almacen)}}function U(n,c){if(1&n){const i=a.EpF();a.TgZ(0,"ion-header")(1,"ion-toolbar",26)(2,"ion-title",27),a._uU(3),a.qZA(),a.TgZ(4,"ion-buttons",28)(5,"ion-button",29),a.NdJ("click",function(){a.CHM(i);const t=a.oxw(2);return a.KtG(t.cancel())}),a._uU(6,"Cancelar"),a.qZA()()()(),a.TgZ(7,"ion-content",22)(8,"form",30)(9,"div",4)(10,"div",31)(11,"ion-item"),a._UZ(12,"ion-input",32),a.qZA(),a.TgZ(13,"ion-item"),a._UZ(14,"ion-input",33),a.qZA(),a.TgZ(15,"ion-item"),a._UZ(16,"ion-input",34),a.qZA()(),a.TgZ(17,"div",35)(18,"ion-datetime",36)(19,"span",37),a._uU(20,"Tiempo"),a.qZA()()()(),a.TgZ(21,"ion-button",38),a.NdJ("click",function(){a.CHM(i);const t=a.oxw(2);return a.KtG(t.submitForm(t.almacen[0].id))}),a._uU(22,"Guardar"),a.qZA()()()}if(2&n){const i=a.oxw(2);a.xp6(3),a.hij("Almacen: ",i.almacen[0].clave_almacen,""),a.xp6(2),a.Q6J("strong",!0),a.xp6(3),a.Q6J("formGroup",i.formularioAlmacen)}}function C(n,c){if(1&n&&(a.TgZ(0,"div")(1,"div",4)(2,"div",16),a._UZ(3,"img",17),a.TgZ(4,"div",18),a._UZ(5,"ion-progress-bar",19),a.qZA()(),a.TgZ(6,"div",20)(7,"h4",21),a._uU(8,"Informaci\xf3n del almacen"),a.qZA(),a.TgZ(9,"div",22)(10,"b"),a._uU(11,"Clave del almacen:"),a.qZA(),a._UZ(12,"br"),a._uU(13),a._UZ(14,"br"),a.TgZ(15,"b"),a._uU(16,"Estado del tanque:"),a.qZA(),a._UZ(17,"br"),a._uU(18),a._UZ(19,"br"),a.TgZ(20,"b"),a._uU(21,"Vigencia de calibiraci\xf3n:"),a.qZA(),a._UZ(22,"br"),a._uU(23),a._UZ(24,"br"),a.TgZ(25,"b"),a._uU(26,"Capacidad almacen:"),a.qZA(),a._UZ(27,"br"),a._uU(28),a._UZ(29,"br"),a.TgZ(30,"b"),a._uU(31,"Capacidad operativa:"),a.qZA(),a._UZ(32,"br"),a._uU(33),a._UZ(34,"br"),a.TgZ(35,"b"),a._uU(36,"Capacidad \xfatil:"),a.qZA(),a._UZ(37,"br"),a._uU(38),a._UZ(39,"br"),a.TgZ(40,"b"),a._uU(41,"Capacidad de fonaje:"),a.qZA(),a._UZ(42,"br"),a._uU(43),a._UZ(44,"br"),a.TgZ(45,"b"),a._uU(46,"Volumen minimo de operci\xf3n:"),a.qZA(),a._UZ(47,"br"),a._uU(48),a.qZA(),a.TgZ(49,"div",21)(50,"ion-button",23),a._UZ(51,"ion-icon",24),a._uU(52," Agregar "),a._UZ(53,"br"),a._uU(54," Registro "),a.qZA(),a.TgZ(55,"ion-modal",25),a.YNc(56,U,23,3,"ng-template"),a.qZA()()()()()),2&n){const i=a.oxw();a.xp6(5),a.Q6J("value",i.cantidadAlmacen1),a.xp6(8),a.hij(" ",i.almacen[0].clave_almacen," "),a.xp6(5),a.hij(" ",i.almacen[0].estado_tanque," "),a.xp6(5),a.hij(" ",i.almacen[0].vigencia_calibracion_tanque," "),a.xp6(5),a.hij(" ",i.almacen[0].capacidad_almacen," "),a.xp6(5),a.hij(" ",i.almacen[0].capacidad_operativa," "),a.xp6(5),a.hij(" ",i.almacen[0].capacidad_util," "),a.xp6(5),a.hij(" ",i.almacen[0].capacidad_fondaje," "),a.xp6(5),a.hij(" ",i.almacen[0].volumen_minimo_operacion," ")}}function P(n,c){1&n&&(a.TgZ(0,"h4",39),a._uU(1," A\xfan no se han creado o selecionado almacenes. "),a.qZA())}const x=[{path:"",component:(()=>{var n;class c{constructor(e,t,s,u,p,m,y){this.api=e,this.authSerivce=t,this.storage=s,this.route=u,this.modal=p,this.toastController=m,this.loadCtrl=y,this.datos=[],this.cantidadAlmacen1=.2,this.cantidadAlmacen2=.5}ngOnInit(){this.storage.getUserLogged()||(this.storage.logout(),this.route.navigate(["/login"],{replaceUrl:!0}))}presentToast(e,t,s){var u=this;return(0,d.Z)(function*(){yield(yield u.toastController.create({message:t,duration:1500,position:e,color:s})).present()})()}generarFormaulario(){var e=this;return(0,d.Z)(function*(){e.formularioAlmacen=new l.cw({id_planta:new l.NI(e.token.user.id_planta,l.kI.required),id_almacen:new l.NI("",l.kI.required),cantidad_inical:new l.NI("",l.kI.required),cantidad_final:new l.NI("",l.kI.required),fecha_llenado:new l.NI("",l.kI.required)})})()}ionViewDidEnter(){var e=this;return(0,d.Z)(function*(){yield e.getInformaicon(),e.generarFormaulario()})()}getInformaicon(){var e=this;return(0,d.Z)(function*(){e.token=e.storage.getUserData(),(yield e.api.getRegistroPipasES(e.token.token,e.token.user.id_planta)).subscribe(t=>{e.generarTabla(t)}),(yield e.api.getRegistroAlmacen(e.token.token,e.token.user.id_planta)).subscribe(t=>{e.registrosAlmacen=t,console.log("\u{1f680} ~ MostrarPage ~ this.registrosAlmacen:",e.registrosAlmacen),e.calcularNivelContenedor(t)}),(yield e.api.getAlmacen(e.token.token,e.token.user.id_planta)).subscribe(t=>{e.almacenDatos=t})})()}generarTabla(e){return(0,d.Z)(function*(){g.fn.DataTable.isDataTable("#listaRegistroPipasPanel")&&g("#listaRegistroPipasPanel").DataTable().destroy(),setTimeout(()=>{new b.Z("#listaRegistroPipasPanel",{language:{url:"/assets/utils/es-ES.json"},columns:[{data:"pipa.clave_pipa",title:"Calve pipa"},{data:"inventario_inical",title:"Inventario Inicial"},{data:"compra",title:"Compra"},{data:"venta",title:"Venta"},{data:"inventario_final",title:"Inventario Final"}],data:e})},300)})()}generarTablaAlmacen(e){return(0,d.Z)(function*(){g.fn.DataTable.isDataTable("#almacenCombustible")&&g("#almacenCombustible").DataTable().destroy(),setTimeout(()=>{new b.Z("#almacenCombustible",{language:{url:"/assets/utils/es-ES.json"},columns:[{data:"almacen.clave_almacen",title:"Clave del almacen"},{data:"cantidad_inical",title:"Cantidad inicial"},{data:"cantidad_final",title:"Cantidad final"},{data:"fecha_llenado",title:"Fecha llenado"}],data:e})},300)})()}calcularNivelContenedor(e){return(0,d.Z)(function*(){})()}submitForm(e){var t=this;return(0,d.Z)(function*(){t.formularioAlmacen.get("id_almacen").setValue(e),t.formularioAlmacen.valid?(yield t.api.createRegistroAlmacen(t.formularioAlmacen.value,t.token.token)).subscribe({next:s=>{t.presentToast("bottom","Se ha creado un nuevo registro","success"),t.formularioAlmacen.reset(),t.modal.dismiss(),setTimeout(()=>{window.location.reload()},500)},error:s=>{console.log(s),t.presentToast("bottom","Algo ha salido mal, vuelve a intentarlo","danger")}}):console.log("Formulario inv\xe1lido")})()}cancel(){this.modal.dismiss(null,"cancel"),this.formularioAlmacen.reset()}selectAlmacen(e){var t=this;return(0,d.Z)(function*(){const s=t.loadCtrl.create({message:"Cargando..."});(yield s).present();const u=t.almacenDatos.filter(m=>m.id==e.target.value);t.almacen=u;const p=t.registrosAlmacen.filter(m=>m.id_almacen==e.target.value);t.generarTablaAlmacen(p),(yield s).dismiss()})()}}return(n=c).\u0275fac=function(e){return new(e||n)(a.Y36(f.Z),a.Y36(h.e),a.Y36(A.V),a.Y36(Z.F0),a.Y36(o.IN),a.Y36(o.yF),a.Y36(o.HT))},n.\u0275cmp=a.Xpm({type:n,selectors:[["app-mostrar"]],decls:23,vars:4,consts:[[3,"fullscreen"],[1,"mb-3"],[1,"card","ion-margin",2,"max-width","100%"],[1,"card-header",2,"background","#2c3d50"],[1,"row"],[1,"col-lg-12","col-md-12","col-sm-12","pt-1",2,"color","white"],["label","Selecciona un almacen","placeholder","Selecciona un almacen",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["elseAlmacen",""],[1,"card","ion-margin","rounded"],[1,"card-hedaer","text-white","text-center","pt-1",2,"background","#2c3d50","color","white"],[1,"table-responsive","p-2"],["id","almacenCombustible",1,"table"],["id","listaRegistroPipasPanel",1,"table"],[3,"value"],[1,"col-md-6",2,"text-align","center"],["src","/assets/img/almcen_gas.png","width","70%","alt","..."],[1,"ion-margin"],[1,"pb-3",3,"value"],[1,"col-md-6","pt-2","pb-2"],[2,"text-align","center"],[1,"ion-padding"],["id","open-modal-almacen-1","color","light"],["slot","start","name","add"],["trigger","open-modal-almacen-1"],[2,"--background","#2c3d50"],[2,"color","white"],["slot","end"],[2,"color","white",3,"strong","click"],[3,"formGroup"],[1,"col-md-4"],["label","Cantidad Inicial","labelPlacement","floating","formControlName","cantidad_inical","type","number"],["label","Cantidad Final","labelPlacement","floating","formControlName","cantidad_final","type","number"],["label","Compra total","labelPlacement","floating","type","text"],[1,"col-md-8"],["formControlName","fecha_llenado","locale","es-ES","hourCycle","h12"],["slot","time-label"],["expand","block",3,"click"],[1,"ion-padding",2,"text-align","center"]],template:function(e,t){if(1&e&&(a.TgZ(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"ion-select",6),a.NdJ("ionChange",function(u){return t.selectAlmacen(u)}),a.YNc(7,T,2,2,"ion-select-option",7),a.qZA()()()(),a.YNc(8,C,57,9,"div",8)(9,P,2,0,"ng-template",null,9,a.W1O),a.qZA()(),a.TgZ(11,"div",10)(12,"div",11)(13,"h4"),a._uU(14,"Registro de llenado de combustible"),a.qZA()(),a.TgZ(15,"div",12),a._UZ(16,"table",13),a.qZA()(),a.TgZ(17,"div",10)(18,"div",11)(19,"h4"),a._uU(20,"Entradas y salidas para la carga de pipas"),a.qZA()(),a.TgZ(21,"div",12),a._UZ(22,"table",14),a.qZA()()()),2&e){const s=a.MAs(10);a.Q6J("fullscreen",!0),a.xp6(7),a.Q6J("ngForOf",t.almacenDatos),a.xp6(),a.Q6J("ngIf",null!=t.almacen)("ngIfElse",s)}},dependencies:[_.sg,_.O5,l._Y,l.JJ,l.JL,o.YG,o.Sm,o.W2,o.x4,o.Gu,o.gu,o.pK,o.Ie,o.X7,o.t9,o.n0,o.wd,o.sr,o.ki,o.as,o.QI,o.j9,l.sg,l.u]}),c})()}];let M=(()=>{var n;class c{}return(n=c).\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[Z.Bz.forChild(x),Z.Bz]}),c})(),q=(()=>{var n;class c{}return(n=c).\u0275fac=function(e){return new(e||n)},n.\u0275mod=a.oAB({type:n}),n.\u0275inj=a.cJS({imports:[_.ez,l.u5,o.Pc,M,l.UX]}),c})()}}]);