"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5187],{5187:(C,h,r)=>{r.r(h),r.d(h,{MostrarPageModule:()=>F});var u=r(6814),g=r(95),s=r(9810),f=r(1147),c=r(5861),b=r(203),p=r(7574),m=r(2276),e=r(9212),T=r(8056),v=r(4228);function Z(t,l){if(1&t&&(e.TgZ(0,"ion-select-option",12),e._uU(1),e.qZA()),2&t){const d=l.$implicit;e.s9C("value",d.id),e.xp6(),e.Oqu(d.modelo_equipo)}}function _(t,l){1&t&&(e.TgZ(0,"ion-card")(1,"ion-card-header",13)(2,"ion-card-title",3),e._uU(3,"Descripci\xf3n del medidor"),e.qZA()(),e.TgZ(4,"div",14),e._UZ(5,"table",15),e.qZA()())}function S(t,l){1&t&&(e.TgZ(0,"ion-card")(1,"ion-card-header",13)(2,"ion-card-title",3),e._uU(3,"Hisotrial de mantenimiento"),e.qZA()(),e.TgZ(4,"div",14),e._UZ(5,"table",16),e.qZA()())}function y(t,l){1&t&&(e.TgZ(0,"ion-card")(1,"ion-card-header",13)(2,"ion-card-title",3),e._uU(3,"Historial de los registros de infromaic\xf3n"),e.qZA()(),e.TgZ(4,"div",14),e._UZ(5,"table",17),e.qZA()())}const I=[{path:"",component:(()=>{var t;class l{constructor(n,a,o,i,M,A){this.apiLaravel=n,this.storage=a,this.route=o,this.modal=i,this.load=M,this.alert=A,this.medidor_turbina=[],this.enableMedidor=!0,this.tablaMantenimeitnoGenerada=!1,this.tablaHistorialGenerada=!1,this.idMedidor=0}ngOnInit(){this.storage.getUserLogged()||(this.storage.logout(),this.route.navigate(["/login"],{replaceUrl:!0}))}ionViewWillEnter(){this.obtenerInformacion()}obtenerInformacion(){var n=this;return(0,c.Z)(function*(){n.brearToken=n.storage.getUserData(),(yield n.apiLaravel.getMedidoresTurbian(n.brearToken.token,n.brearToken.user.id_planta)).subscribe({next:a=>{n.medidor_turbina=a},error:a=>{console.log("error: ",a)}}),(yield n.apiLaravel.getRegistroMantenimientoMedidor(n.brearToken.token,n.brearToken.user.id_planta)).subscribe({next:a=>{n.mantenminetos=a},error:a=>{console.log(a)}}),(yield n.apiLaravel.getRegistroInformacionMedidor(n.brearToken.token,n.brearToken.user.id_planta)).subscribe({next:a=>{n.historial_informacion=a},error:a=>{console.log(a)}})})()}historialMantenimiento(n){var a=this;return(0,c.Z)(function*(){(yield a.apiLaravel.getRegistroMantenimientoMedidor(a.brearToken.token,a.brearToken.user.id_planta)).subscribe({next:o=>{const i=o.filter(M=>M.id_medidor==n);a.generarModalMantemineito(i)},error:o=>{console.log("error: ",o)}})})()}generarModalMantemineito(n){var a=this;return(0,c.Z)(function*(){yield(yield a.modal.create({component:p.S,componentProps:{mantenimiento:n}})).present()})()}onSelectElement(n){var a=this;return(0,c.Z)(function*(){const o=a.medidor_turbina.filter(i=>i.id==n.target.value);a.medidor_seleccionado=o,a.idMedidor=n.target.value,yield a.generarTablaMedidorSeleccionado(o)})()}generarTablaMedidorSeleccionado(n){var a=this;return(0,c.Z)(function*(){const o=yield a.load.create({message:"Cargando..."});o.present(),m.fn.DataTable.isDataTable("#tableMedidorSeleccionado")&&m("#tableMedidorSeleccionado").DataTable().destroy(),new b.Z("#tableMedidorSeleccionado",{language:{url:"/assets/utils/es-ES.json"},data:n,columns:[{data:"modelo_equipo",title:"Modelo"},{data:"rango_flujo",title:"R. Flujo"},{data:"rango_temperatura",title:"R. Temp"},{data:"numero_serie",title:"No. Serie"},{data:"precision",title:"Precisi\xf3n"},{data:"suministro_energia",title:"S. Energ\xeda"},{data:"salida_modelo",title:"S. Modelo"},{data:"fecha",title:"Fecha"}],paging:!1,searching:!1,info:!1}),a.valorInformacion=void 0,a.tablaMantenimeitnoGenerada=!1,setTimeout(()=>{},1e3),o.dismiss(),a.enableMedidor=!1})()}onSelectInformacion(n){var a=this;return(0,c.Z)(function*(){n.target.value.map(i=>"mantenimiento"==i?a.generarMantenimientoTable():"info_historial"==i?a.generarHistorialInformacionTable():null)})()}generarMantenimientoTable(){var n=this;return(0,c.Z)(function*(){const a=n.mantenminetos.filter(o=>o.id_medidor==n.idMedidor);if(0!=a.length){n.tablaMantenimeitnoGenerada=!0;const o=yield n.load.create({message:"Cargando..."});yield o.present(),m.fn.DataTable.isDataTable("#tableMantenimientoSelecionado")&&m("#tableMantenimientoSelecionado").DataTable().destroy(),new b.Z("#tableMantenimientoSelecionado",{language:{url:"/assets/utils/es-ES.json"},data:a,columns:[{data:"tipo_mantenimiento",title:"Tipo de mantenimiento"},{data:"responsable",title:"Responsable del mantenimiento"},{data:"observaciones",title:"Observaciones"},{data:"created_at",title:"Fecha del mantenimiento"}]}),setTimeout(()=>{},1e3),yield o.dismiss()}else yield(yield n.alert.create({message:"No se han encontrado registros de mantenimientos",buttons:[{text:"Aceptar",role:"confirm"}]})).present()})()}generarHistorialInformacionTable(){var n=this;return(0,c.Z)(function*(){const a=n.historial_informacion.filter(o=>o.id_medidor==n.idMedidor);if(0!=a.length){n.tablaHistorialGenerada=!0;const o=yield n.load.create({message:"Cargando..."});yield o.present(),m.fn.DataTable.isDataTable("#tableInformacionSelecionado")&&m("#tableInformacionSelecionado").DataTable().destroy(),new b.Z("#tableInformacionSelecionado",{language:{url:"/assets/utils/es-ES.json"},data:a,columns:[{data:"informacion_medidor",title:"Informacion del medidor"},{data:"created_at",title:"Fecha del registro"}]}),setTimeout(()=>{},1e3),yield o.dismiss()}else yield(yield n.alert.create({message:"No se han encontrado registros historial de infromaic\xf3n del medidor",buttons:[{text:"Aceptar",role:"confirm"}]})).present()})()}}return(t=l).\u0275fac=function(n){return new(n||t)(e.Y36(T.Z),e.Y36(v.V),e.Y36(f.F0),e.Y36(s.IN),e.Y36(s.HT),e.Y36(s.Br))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-mostrar"]],decls:20,vars:8,consts:[[3,"fullscreen"],[1,"ion-padding"],[2,"--background","#2c3d50"],[2,"color","white"],[1,"row"],[1,"col-md-6"],["label","Selecciona un medidor","labelPlacement","floating","placeholder","Selecciona un medidor",2,"color","white",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["label","Informaci\xf3n del medidor","labelPlacement","floating","placeholder","Selecciona la infromaci\xf3n que deseas obtener del medidor",2,"color","white",3,"disabled","ngModel","multiple","ionChange","ngModelChange"],["value","mantenimiento"],["value","info_historial"],[4,"ngIf"],[3,"value"],[2,"--background","#2c3d50","text-align","center"],[1,"table-responsive","p-2"],["id","tableMedidorSeleccionado",1,"table"],["id","tableMantenimientoSelecionado",1,"table"],["id","tableInformacionSelecionado",1,"table"]],template:function(n,a){1&n&&(e.TgZ(0,"ion-content",0)(1,"div",1)(2,"ion-card",2)(3,"ion-card-header")(4,"ion-card-title",3),e._uU(5," Selecciona un medidor para conocer el historial de su informaci\xf3n "),e.qZA()(),e.TgZ(6,"ion-card-content")(7,"div",4)(8,"div",5)(9,"ion-select",6),e.NdJ("ionChange",function(i){return a.onSelectElement(i)}),e.YNc(10,Z,2,2,"ion-select-option",7),e.qZA()(),e.TgZ(11,"div",5)(12,"ion-select",8),e.NdJ("ionChange",function(i){return a.onSelectInformacion(i)})("ngModelChange",function(i){return a.valorInformacion=i}),e.TgZ(13,"ion-select-option",9),e._uU(14,"Mantenimiento"),e.qZA(),e.TgZ(15,"ion-select-option",10),e._uU(16,"Historial de registros del medidor"),e.qZA()()()()()(),e.YNc(17,_,6,0,"ion-card",11)(18,S,6,0,"ion-card",11)(19,y,6,0,"ion-card",11),e.qZA()()),2&n&&(e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("ngForOf",a.medidor_turbina),e.xp6(2),e.Q6J("disabled",a.enableMedidor)("ngModel",a.valorInformacion)("multiple",!0),e.xp6(5),e.Q6J("ngIf",null!=a.medidor_seleccionado),e.xp6(),e.Q6J("ngIf",a.tablaMantenimeitnoGenerada),e.xp6(),e.Q6J("ngIf",a.tablaHistorialGenerada))},dependencies:[u.sg,u.O5,g.JJ,g.On,s.PM,s.FN,s.Zi,s.Dq,s.W2,s.t9,s.n0,s.QI]}),l})()}];let P=(()=>{var t;class l{}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[f.Bz.forChild(I),f.Bz]}),l})(),F=(()=>{var t;class l{}return(t=l).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.ez,g.u5,s.Pc,P]}),l})()}}]);